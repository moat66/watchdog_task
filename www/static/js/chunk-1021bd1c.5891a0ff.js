(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1021bd1c"],{"127a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"result-success"},[a("div",{staticStyle:{height:"1200px"}},[a("split-pane",{attrs:{split:"vertical","min-percent":10,"default-percent":15}},[a("template",{slot:"paneL"},[a("a-input-search",{staticStyle:{"margin-bottom":"8px"},attrs:{placeholder:"搜索",disabled:e.operate.disable},on:{pressEnter:e.onSearch,search:e.onSearch},model:{value:e.operate.searchValue,callback:function(t){e.$set(e.operate,"searchValue",t)},expression:"operate.searchValue"}}),a("div",{staticClass:"left-tree-scroller left-tree-container"},[a("a-tree",{staticClass:"left-tree",attrs:{expandedKeys:e.script.expandedKeys,"show-line":!0,disabled:e.operate.disable,"tree-data":e.script.fileTreeData},on:{"update:expandedKeys":function(t){return e.$set(e.script,"expandedKeys",t)},"update:expanded-keys":function(t){return e.$set(e.script,"expandedKeys",t)},select:e.onSelect}})],1)],1),a("template",{slot:"paneR"},[a("div",{staticClass:"table-operations"},[a("a-row",{attrs:{gutter:24,type:"flex",justify:"space-around",align:"middle"}},[a("a-col",{staticClass:"cores-bottom",attrs:{md:12,sm:24}},[a("a-space",{attrs:{size:10}},[a("a-button",{staticStyle:{"margin-left":"3px"},attrs:{type:"primary",icon:"plus",disabled:e.checkAddDisabled()},on:{click:function(t){e.operate.addShow=!0}}},[e._v(e._s(e.$t("add")))]),a("a-select",{staticStyle:{width:"120px"},attrs:{disabled:e.operate.disable,placeholder:e.$t("operate.container")},on:{select:function(t){return e.onScriptList(e.operate.qlId)}},model:{value:e.operate.qlId,callback:function(t){e.$set(e.operate,"qlId",t)},expression:"operate.qlId"}},[e._l(e.operate.qlNameMapper,(function(t,r){return[a("a-select-option",{key:r,attrs:{value:r,title:t}},[e._v(" "+e._s(t)+" ")])]}))],2)],1)],1),a("a-col",{staticClass:"cores-bottom",staticStyle:{"text-align":"right"},attrs:{flex:"right",md:12,sm:24}},[a("a-space",{attrs:{size:10}},[a("QLBox",{ref:"qlBox",attrs:{"all-ql-id":e.operate.allQlId,"plain-options":e.operate.plainOptions}}),a("a-button",{attrs:{type:"danger",icon:"delete",disabled:e.checkDisabled()},on:{click:e.deleteScript}},[e._v(e._s(e.$t("operate.delete")))]),a("a-button",{attrs:{type:"primary",icon:"highlight",disabled:e.checkDisabled()},on:{click:e.saveScript}},[e._v(e._s(e.$t("operate.save")))])],1)],1)],1)],1),a("div",{staticClass:"monaco-box",staticStyle:{"margin-top":"15px"}},[a("MonacoEditor",{ref:"child",attrs:{codes:e.script.content,filename:e.script.filename}})],1)])],2)],1),a("a-modal",{attrs:{title:e.$t("new"),width:600,destroyOnClose:!0},on:{ok:e.addScriptClose},model:{value:e.operate.addShow,callback:function(t){e.$set(e.operate,"addShow",t)},expression:"operate.addShow"}},[a("a-form",{attrs:{form:e.form,layout:"vertical"}},[a("a-row",{attrs:{gutter:24,type:"flex",justify:"space-around",align:"middle"}},[a("a-col",{attrs:{md:18,sm:24}},[a("a-form-item",{attrs:{label:e.$t("type")}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:e.$ta("selects|type")}]}],expression:"['type', {rules: [{ required: true, message: $ta('selects|type')}]}]"}],attrs:{name:"radioGroup"}},[a("a-radio",{attrs:{value:1}},[e._v(" 文件 ")]),a("a-radio",{attrs:{value:2}},[e._v(" 文件夹 ")])],1)],1),1===e.form.getFieldValue("type")?a("a-form-item",{attrs:{label:e.$t("filename")}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["filename",{rules:[{required:!0,message:e.$ta("input|filename"),whitespace:!0}]}],expression:"['filename', {rules: [{ required: true, message: $ta('input|filename'), whitespace: true}]}]"}],attrs:{placeholder:e.$ta("input|filename")}})],1):e._e(),2===e.form.getFieldValue("type")?a("a-form-item",{attrs:{label:e.$t("folderName")}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["directory",{rules:[{required:!0,message:e.$ta("input|folderName"),whitespace:!0}]}],expression:"['directory', {rules: [{ required: true, message: $ta('input|folderName'), whitespace: true}]}]"}],attrs:{placeholder:e.$ta("input|folderName")}})],1):e._e(),a("a-form-item",{attrs:{label:e.$t("path")}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["path"],expression:"['path']"}],attrs:{placeholder:e.$ta("selects|path"),"dropdown-style":{maxHeight:"250px",overflow:"auto"},"tree-data":e.directoryTree,"tree-default-expand-all":""}})],1)],1)],1)],1)],1)],1)},n=[],i=(a("caad"),a("c975"),a("baa5"),a("b0c0"),a("b64b"),a("2532"),a("2ca0"),a("96cf"),a("1da1")),s=a("dc9e"),o=a("19ab"),c=a.n(o),l=a("7424"),p=a("b775");function u(e){return d.apply(this,arguments)}function d(){return d=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("path",t.path?t.path:""),a.append("qlIds",t.qlIds),a.append("filename",t.filename),a.append("content",""),e.abrupt("return",Object(p["f"])(l["QL_SCRIPT"].BASE,p["a"].POST,a,{headers:{"Content-Type":"multipart/form-data"}}));case 6:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return h=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p["f"])(l["QL_SCRIPT"].BASE,p["a"].PUT,t));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return v=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p["f"])(l["QL_SCRIPT"].BASE,p["a"].DELETE,t));case 1:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function g(e){return b.apply(this,arguments)}function b(){return b=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p["f"])(l["QL_SCRIPT"].DIRECTORY,p["a"].POST,t));case 1:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return w=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p["f"])(l["QL_SCRIPT"].BASE+t,p["a"].GET));case 1:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function $(e,t,a){return x.apply(this,arguments)}function x(){return x=Object(i["a"])(regeneratorRuntime.mark((function e(t,a,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p["f"])(l["QL_SCRIPT"].BASE+t+"/"+a,p["a"].GET,r));case 1:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}var S=a("2472"),I=a("498a"),T=a("c695"),q={name:"Script",i18n:a("45c7"),components:{MonacoEditor:s["a"],splitPane:c.a,QLBox:I["a"]},data:function(){return{form:this.$form.createForm(this),directoryTree:[],script:{expandedKeys:[],fileTreeData:[],treeData:[],content:"请选择脚本文件",filename:"textarea.txt",scriptKey:"",path:""},operate:{searchValue:"",disable:!1,allQlId:[],selectValue:[],plainOptions:[],qlNameMapper:{},qlId:void 0,tmp:{is:!0,qlId:void 0},addShow:!1}}},methods:{checkDisabled:function(){var e;return this.operate.disable||0===(null===(e=this.$refs.qlBox)||void 0===e?void 0:e.getSelectValue().length)||0===this.script.scriptKey.length},checkAddDisabled:function(){var e;return 0===(null===(e=this.$refs.qlBox)||void 0===e?void 0:e.getSelectValue().length)||0===Object.keys(this.operate.qlNameMapper).length},onScriptList:function(e){var t=this;this.script={expandedKeys:[],fileTreeData:[],treeData:[],content:"请选择脚本文件",filename:"textarea.txt",scriptKey:"",path:""},this.$nextTick((function(){t.$refs.child.changeModel()})),this.scriptList(e),this.operate.tmp.is=!1},onSelect:function(e){var t=this;0!==e.length&&(this.$set(this.operate,"disable",!0),this.$set(this.script,"filename",e[0].includes("/")?e[0].substring(e[0].lastIndexOf("/")+1):e[0]),this.$set(this.script,"scriptKey",e[0]),this.$set(this.script,"path",e[0].includes("/")?e[0].substring(0,e[0].lastIndexOf("/")):""),$(this.operate.tmp.is?this.operate.tmp.qlId:this.operate.qlId,this.script.filename,{path:this.script.path}).then((function(e){var a,r,n=200===(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.code)?null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.data:"请选择脚本文件";t.$set(t.script,"content",n),t.$nextTick((function(){t.$refs.child.changeModel()})),t.$set(t.operate,"disable",!1)})).catch((function(e){t.$message.error(e.message),t.$set(t.operate,"disable",!1)})))},scriptList:function(e){var t=this;this.$set(this.operate,"disable",!0),y(e).then((function(e){var a,r,n=null!==(a=null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.data)&&void 0!==a?a:[];t.loadIsLeaf(n),t.directoryTree=t.directoryHd(n,[]),t.$set(t.script,"fileTreeData",n),t.$set(t.script,"treeData",n),t.$set(t.operate,"disable",!1)})).catch((function(){t.$set(t.operate,"disable",!1)}))},debounce:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;clearTimeout(this.timeout),this.timeout=setTimeout((function(){e()}),t)},onSearch:function(){var e=this,t=this.operate.searchValue;this.script.expandedKeys=[],t?this.debounce((function(){e.script.fileTreeData=T.searchTree(e.script.treeData,(function(a){return a.title.toLowerCase().indexOf(t.toLowerCase())>-1&&(a.parent&&e.script.expandedKeys.push(a.parent),e.script.expandedKeys.push(a.key),!0)}),{children:"children"})})):this.script.fileTreeData=this.script.treeData},loadIsLeaf:function(e){for(var t=0;t<e.length;t++)e[t].children&&this.loadIsLeaf(e[t].children),e[t].isLeaf=!e[t].children||e[t].title.includes(".")},saveScript:function(){var e=this;this.confirmPop("confirm.updateTitle","confirm.updateContent",Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:f({content:e.$refs.child.getValueCode(),filename:e.script.filename,path:e.script.path,qlIds:e.$refs.qlBox.getSelectValue()}).then((function(t){200===t.data.code?e.$message.success(t.data.message):e.$message.error(t.data.message)})).catch((function(t){e.$message.error(t.message)}));case 1:case"end":return t.stop()}}),t)}))))},deleteScript:function(){var e=this,t=this.isFile(this.script.treeData,this.script.scriptKey);this.confirmPop("confirm.deleteTitle","confirm.deleteContent",Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:m({type:t?"file":"directory",filename:e.script.filename,path:e.script.path,qlIds:e.$refs.qlBox.getSelectValue()}).then((function(t){200===t.data.code?e.$message.success(t.data.message):e.$message.error(t.data.message),e.onScriptList(e.operate.tmp.is?e.operate.tmp.qlId:e.operate.qlId),e.operate.tmp.is=isNaN(e.operate.qlId)})).catch((function(t){e.$message.error(t.message)}));case 1:case"end":return a.stop()}}),a)}))))},confirmPop:function(e,t,a){this.$confirm({title:this.$t(e),content:this.$t(t),onOk:a})},isFile:function(e,t){for(var a=0;a<e.length;a++){if(t===e[a].key)return e[a].isLeaf;if(t.startsWith(e[a].key)&&e[a].children&&this.isFile(e[a].children))return!0}return!1},addScriptClose:function(){var e=this;this.form.validateFields((function(t,a){if(!t)switch(e.form.getFieldValue("type")){case 1:e.saveFile(a);break;case 2:e.saveDirectory(a);break}}))},saveFile:function(e){var t=this;e.qlIds=this.$refs.qlBox.getSelectValue(),u(e).then((function(e){var a,r,n;200===(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.code)?(t.$message.success(null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message),t.operate.addShow=!1,t.onScriptList(t.operate.tmp.is?t.operate.tmp.qlId:t.operate.qlId),t.operate.tmp.is=isNaN(t.operate.qlId)):t.$message.error(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)})).catch((function(e){t.$message.error(e.message)}))},saveDirectory:function(e){var t=this;e.qlIds=this.$refs.qlBox.getSelectValue(),e.path=e.path||"",g(e).then((function(e){var a,r,n;200===(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.code)?(t.$message.success(null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message),t.operate.addShow=!1,t.onScriptList(t.operate.tmp.is?t.operate.tmp.qlId:t.operate.qlId),t.operate.tmp.is=isNaN(t.operate.qlId)):t.$message.error(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)})).catch((function(e){t.$message.error(e.message)}))},directoryHd:function(e,t){for(var a=0;a<e.length;a++)if(!e[a].isLeaf){var r={key:e[a].key,value:e[a].key,title:e[a].title,children:[]};t.push(r),e[a].children&&this.directoryHd(e[a].children,r.children)}return t}},mounted:function(){var e=this;Object(S["d"])().then((function(t){var a,r,n=null!==(a=null===t||void 0===t||null===(r=t.data)||void 0===r?void 0:r.data)&&void 0!==a?a:[];if(n){for(var i=0;i<n.length;i++)n[i].enable&&(e.operate.plainOptions.push({label:n[i].name,value:n[i].id}),e.$set(e.operate.qlNameMapper,n[i].id,n[i].name),e.operate.selectValue.push(n[i].id),e.operate.allQlId.push(n[i].id),e.operate.qlId||(e.$set(e.operate,"qlId",n[i].name),e.operate.tmp.qlId=n[i].id,e.scriptList(n[i].id)));e.$nextTick((function(){e.$refs.qlBox.setSelectValue(e.operate.selectValue)}))}}))}},k=q,O=(a("e6ba"),a("0c7c")),C=Object(O["a"])(k,r,n,!1,null,"91872646",null);t["default"]=C.exports},2472:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return p})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return v}));a("96cf");var r=a("1da1"),n=a("7424"),i=a("b775");function s(){return o.apply(this,arguments)}function o(){return o=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["f"])(n["QL_DEPICT"],i["a"].GET));case 1:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}function c(e){return l.apply(this,arguments)}function l(){return l=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["f"])(n["QL_DEPICT"],i["a"].POST,t));case 1:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function p(e){return u.apply(this,arguments)}function u(){return u=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["f"])(n["QL_DEPICT"],i["a"].PUT,t));case 1:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return f=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["f"])(n["QL_DEPICT_ENABLE"]+t,i["a"].PUT));case 1:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return m=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["f"])(n["QL_DEPICT_DISABLE"]+t,i["a"].PUT));case 1:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function v(e){return g.apply(this,arguments)}function g(){return g=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i["f"])(n["QL_DEPICT"]+t,i["a"].DELETE));case 1:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}},"45c7":function(e,t){e.exports={messages:{CN:{operate:{container:"请选择容器",filename:"请选择配置文件",syncConfig:"请选择要同步到的容器",save:"保存",delete:"删除"},confirm:{updateTitle:"确认更新？",updateContent:"你确认要更新文件内容并同步到已选择的其它容器吗？",deleteTitle:"确认删除？",deleteContent:"你确认要删除文件或目录并同步删除已选择的其它容器内容吗？"},new:"新建",add:"添加",input:"请输入",select:"选择",selects:"请选择",filename:"文件名称",folderName:"文件夾名",type:"类型",path:"父路径"},HK:{operate:{container:"請選擇容器",filename:"請選擇配置文件",syncConfig:"請選擇要同步到的容器",save:"保存",delete:"删除"},confirm:{updateTitle:"確認更新？",updateContent:"你確認要更新文件內容並同步到已選擇的其它容器嗎？",deleteTitle:"確認删除？",deleteContent:"你確認要删除文件或目錄並同步刪除已選擇的其它容器內容嗎？"},new:"新建",add:"添加",input:"請輸入",select:"選擇",selects:"請選擇",filename:"文件名称",folderName:"文件夾名",type:"類型",path:"父路徑"},US:{operate:{container:"Please select container",filename:"Select a configuration file",syncConfig:"Select the container you want to sync to",save:"save",delete:"delete"},confirm:{updateTitle:"确认更新？",updateContent:"你确认要更新文件内容并同步到以选择的其它容器吗？"},add:"Add",input:"Please enter",select:"select",selects:"Please select",filename:"File Name",folderName:"Folder Name",path:"Parent path"}}}},"69a8":function(e,t,a){},e6ba:function(e,t,a){"use strict";var r=a("69a8"),n=a.n(r);n.a}}]);